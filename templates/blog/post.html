{% extends 'blog/base.html' %}
{% load staticfiles %}


{% block content %}
    {% include 'blog/page_header.html' with header_img_url=post.picture.url header_title='Clean Blog' header_subtitle='A Blog Theme by Start Bootstrap' %}
    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-md-10 mx-auto">


                    <h2 class="section-heading">{{ post.title }}</h2>
                    <a href="{% url 'sorted-category' post.category.get %}"><span
                            class="badge badge-warning">{{ post.category.get }}</span></a>

                    <p class="post-meta">Posted by <a
                            href="{% url 'user-posts' post.author %}">{{ post.author.username }}</a>
                        on {{ post.date_posted|date:"F d, Y" }}</p>


                    <img class="img-fluid" src="{{ post.picture.url }}">

                    <p>{{ post.content }}</p>

                    <p><a class="like-btn" data-href="{{ post.get_api_like_url }}" data-likes="{{ post.likes.count }}"
                          href="{{ post.get_like_url }}">{{ post.likes.count }} Like</a></p>
                    {% if object.author == user %}
                        <div>
                            <a class="btn btn-secondary btn-sm mt-1 mb-1"
                               href="{% url 'post-update' object.id %}">Update</a>
                            <a class="btn btn-danger btn-sm mt-1 mb-1"
                               href="{% url 'post-delete' object.id %}">Delete</a>
                        </div>
                    {% endif %}
                    <hr>

                    <a class="btn btn-default" href="{% url 'add_comment_to_post' pk=post.pk %}">Add comment</a>

                    {% for comment in post.comments.all %}
                        {% if user.is_authenticated %}
                            <div class="comment">
                                <div class="row">
                                    <p><img class="rounded-circle account-img ml-3" src="{{ comment.author.image.url }}"
                                            width="35" height="35"></p>
                                    <object><p class="post-meta ml-2 "><a
                                            href="{% url 'user-posts' comment.author %}">{{ comment.author.username }}</a>
                                    </p>
                                    </object>
                                    <p class="ml-3">{{ comment.created_date }}</p>
                                </div>
                                <p>{{ comment.text|linebreaks }}</p>
                                <hr>
                            </div>
                        {% endif %}
                    {% empty %}
                        <p>No comments here yet :(</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </article>
{% endblock content %}

